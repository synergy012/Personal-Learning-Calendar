<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jewish Learning Calendar</title>
    <style>
        body {
            font-family: 'Times New Roman', serif;
            margin: 0;
            padding: 10px;
            background: #f5f5f5;
            overflow-x: auto;
        }
        
        .controls {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .controls h2 {
            margin-top: 0;
            color: #2c3e50;
            font-size: 18px;
        }
        
        .control-group {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }
        
        select, button {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            min-width: 120px;
        }
        
        button {
            background: #3498db;
            color: white;
            cursor: pointer;
            border: none;
            white-space: nowrap;
        }
        
        button:hover {
            background: #2980b9;
        }
        
        .print-btn {
            background: #27ae60;
        }
        
        .export-btn {
            background: #27ae60;
        }
        
        .export-btn:hover {
            background: #229954;
        }
        
        .calendar-container {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            page-break-after: always;
            margin-bottom: 30px;
            width: 100%;
            max-width: 100%;
        }
        
        .calendar-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: center;
        }
        
        .calendar-header h1 {
            margin: 0;
            font-size: 20px;
            font-weight: bold;
        }
        
        .calendar-header .hebrew-month {
            font-size: 14px;
            margin-top: 5px;
            opacity: 0.9;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            width: 100%;
        }
        
        .calendar-cell {
            border: 1px solid #e0e0e0;
            min-height: 100px;
            padding: 4px;
            position: relative;
            background: white;
            overflow: hidden;
            font-size: 10px;
        }
        
        .calendar-cell.other-month {
            background: #f8f9fa;
            color: #6c757d;
        }
        
        .calendar-cell.shabbat {
            background: #fff8dc;
        }
        
        .calendar-cell.today {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
        }
        
        .calendar-cell.today .secular-date {
            color: white;
            font-weight: bold;
        }
        
        .calendar-cell.today .hebrew-date {
            color: #ecf0f1;
        }
        
        .calendar-cell.today .learning-title {
            color: white;
        }
        
        .day-header {
            background: #34495e;
            color: white;
            padding: 8px 2px;
            text-align: center;
            font-weight: bold;
            font-size: 11px;
        }
        
        .date-info {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 4px;
        }
        
        .secular-date {
            font-weight: bold;
            font-size: 12px;
            color: #2c3e50;
        }
        
        .hebrew-date {
            font-size: 9px;
            color: #7f8c8d;
            text-align: right;
            direction: rtl;
        }
        
        .holiday-name {
            background: #e74c3c;
            color: white;
            padding: 1px 3px;
            border-radius: 3px;
            font-size: 8px;
            margin-bottom: 2px;
            display: block;
            text-align: center;
        }
        
        .learning-section {
            margin-top: 3px;
            font-size: 11px;
            line-height: 1.1;
        }
        
        .learning-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 1px;
            gap: 2px;
        }
        
        .checkbox {
            width: 8px;
            height: 8px;
            border: 1px solid #333;
            display: inline-block;
            margin-right: 2px;
            margin-top: 1px;
            flex-shrink: 0;
            cursor: pointer;
        }
        
        .checkbox.checked {
            background-color: #27ae60;
            border-color: #27ae60;
            color: white;
            font-size: 6px;
            font-weight: bold;
            text-align: center;
            line-height: 8px;
        }
        
        .learning-label {
            color: #34495e;
            font-size: 12px;
            line-height: 1.0;
            word-break: break-all;
            text-decoration: none;
        }
        
        .learning-label:hover {
            text-decoration: underline;
        }
        
        .mishnah-ref {
            color: #e67e22;
            font-weight: bold;
        }
        
        .navi-ref {
            color: #27ae60;
            font-weight: bold;
        }
        
        .mb-ref {
            color: #8e44ad;
            font-weight: bold;
        }
        
        .learning-title {
            font-weight: bold;
            color: #2c3e50;
            font-size: 12px;
            margin-bottom: 2px;
        }
        
        .current-position {
            background: #ecf0f1;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 10px;
        }
        
        .current-position h3 {
            margin: 0 0 5px 0;
            color: #2c3e50;
            font-size: 14px;
        }
        
        .current-position div {
            margin-bottom: 3px;
            font-size: 12px;
        }
        
        @media print {
            .controls {
                display: none;
            }
            
            .calendar-cell {
                min-height: 80px;
                font-size: 8px;
            }
            
            .learning-label {
                font-size: 11px;
            }
        }
        
        @media screen and (max-width: 768px) {
            .calendar-cell {
                min-height: 80px;
                padding: 3px;
                font-size: 8px;
            }
            
            .learning-section {
                font-size: 7px;
            }
            
            .learning-label {
                font-size: 7px;
            }
        }
    </style>
</head>
<body>
    <div class="controls">
        <h2>Jewish Learning Calendar</h2>
        
        <div class="current-position">
            <h3>Current Learning Position:</h3>
            <div><strong>Mishnah:</strong> Tomorrow (July 20) - Kesubos 7:9 & 7:10</div>
            <div><strong>Navi:</strong> Tomorrow (July 20) - Melachim II Chapter 18</div>
            <div><strong>Mishnah Berurah:</strong> Started July 2nd - Chicago Center Amud Yomi</div>
        </div>
        
        <div class="control-group">
            <label><strong>Select Month:</strong></label>
            <select id="monthSelect">
                <option value="2025-7">July 2025</option>
                <option value="2025-8">August 2025</option>
                <option value="2025-9">September 2025</option>
                <option value="2025-10">October 2025</option>
                <option value="2025-11">November 2025</option>
                <option value="2025-12">December 2025</option>
                <option value="2026-1">January 2026</option>
                <option value="2026-2">February 2026</option>
                <option value="2026-3">March 2026</option>
                <option value="2026-4">April 2026</option>
                <option value="2026-5">May 2026</option>
                <option value="2026-6">June 2026</option>
                <option value="2026-7">July 2026</option>
                <option value="2026-8">August 2026</option>
                <option value="2026-9">September 2026</option>
                <option value="2026-10">October 2026</option>
                <option value="2026-11">November 2026</option>
                <option value="2026-12">December 2026</option>
            </select>
            <button id="generateBtn">Generate Calendar</button>
            <button id="printBtn" class="print-btn">Print Calendar</button>
            <button id="exportBtn" class="export-btn">Export to iPhone Calendar</button>
        </div>
    </div>

    <div id="calendarOutput"></div>

    <script>
        // Mishnah order and structure
        const mishnayos = {
            // Seder Zeraim
            'Berachos': { chapters: [5, 8, 6, 7, 5, 8, 5, 8, 5] },
            'Peah': { chapters: [6, 8, 8, 11, 8, 11, 8, 9] },
            'Demai': { chapters: [4, 5, 6, 7, 11, 12, 8] },
            'Kilayim': { chapters: [9, 11, 7, 9, 8, 9, 8, 6, 10] },
            'Sheviis': { chapters: [8, 10, 10, 10, 9, 6, 7, 11, 9, 9] },
            'Terumos': { chapters: [10, 6, 9, 13, 9, 6, 7, 12, 7, 12, 10] },
            'Maasros': { chapters: [8, 8, 10, 6, 8] },
            'Maaser Sheni': { chapters: [7, 10, 13, 12, 15] },
            'Challah': { chapters: [9, 8, 10, 11] },
            'Orlah': { chapters: [9, 17, 9] },
            'Bikkurim': { chapters: [11, 11, 12, 5] },
            // Seder Moed
            'Shabbos': { chapters: [11, 7, 6, 2, 4, 10, 4, 7, 7, 6, 6, 6, 7, 4, 3, 8, 8, 3, 6, 5, 3, 6, 5, 5] },
            'Eruvin': { chapters: [10, 6, 9, 11, 9, 10, 11, 11, 4, 15] },
            'Pesachim': { chapters: [7, 8, 8, 9, 10, 6, 13, 8, 11, 9] },
            'Shekalim': { chapters: [7, 5, 4, 9, 6, 6, 7, 8] },
            'Yoma': { chapters: [8, 7, 11, 6, 7, 8, 5, 9] },
            'Sukkah': { chapters: [11, 9, 15, 10, 8] },
            'Beitzah': { chapters: [10, 10, 8, 7, 7] },
            'Rosh Hashanah': { chapters: [9, 9, 8, 9] },
            'Taanit': { chapters: [7, 10, 9, 8] },
            'Megillah': { chapters: [11, 6, 6, 10] },
            'Moed Katan': { chapters: [10, 5, 9] },
            'Chagigah': { chapters: [8, 7, 8] },
            // Seder Nashim (including Yevamos)
            'Yevamos': { chapters: [4, 10, 10, 13, 6, 6, 6, 6, 6, 9, 7, 6, 13, 9, 10, 7] },
            'Kesubos': { chapters: [10, 10, 9, 12, 9, 7, 10, 8, 9, 6, 6, 4] },
            'Nedarim': { chapters: [4, 5, 11, 8, 6, 10, 9, 7, 10, 8, 12] },
            'Nazir': { chapters: [7, 10, 7, 7, 7, 11, 4, 2, 5] },
            'Sotah': { chapters: [9, 6, 8, 5, 5, 4, 8, 7, 15] },
            'Gittin': { chapters: [6, 7, 8, 9, 9, 7, 9, 10, 10] },
            'Kiddushin': { chapters: [10, 10, 13, 14] },
            // Seder Nezikin
            'Baba Kamma': { chapters: [4, 6, 11, 9, 7, 6, 7, 7, 12, 10] },
            'Baba Metzia': { chapters: [8, 10, 12, 12, 11, 8, 11, 9, 13, 6] },
            'Baba Basra': { chapters: [6, 14, 8, 9, 11, 8, 4, 8, 10, 8] },
            'Sanhedrin': { chapters: [6, 5, 8, 5, 5, 6, 11, 7, 6, 6, 6] },
            'Makkos': { chapters: [10, 8, 16] },
            'Shevuos': { chapters: [7, 5, 11, 13, 5, 7, 8, 6] },
            'Eduyos': { chapters: [14, 10, 12, 12, 7, 3, 9, 7] },
            'Avodah Zarah': { chapters: [9, 7, 10, 12, 12] },
            'Avos': { chapters: [18, 16, 18, 22, 23, 11] },
            'Horayos': { chapters: [5, 7, 8] },
            // Seder Kodashim
            'Zevachim': { chapters: [4, 5, 6, 6, 8, 7, 6, 12, 7, 8, 8, 6, 8, 10] },
            'Menachos': { chapters: [4, 5, 7, 5, 9, 7, 6, 7, 9, 9, 9, 5, 11] },
            'Chullin': { chapters: [7, 10, 7, 7, 5, 7, 6, 6, 8, 4, 2, 5] },
            'Bechoros': { chapters: [7, 9, 4, 10, 6, 12, 7, 10, 8] },
            'Arachin': { chapters: [4, 6, 5, 4, 6, 5, 5, 7, 8] },
            'Temurah': { chapters: [6, 3, 5, 4, 6, 5, 6] },
            'Kerisos': { chapters: [7, 6, 10, 3, 8, 9] },
            'Meilah': { chapters: [4, 9, 8, 6, 5, 6] },
            'Tamid': { chapters: [4, 5, 9, 3, 6, 4, 4] },
            'Middos': { chapters: [9, 6, 8, 7, 4] },
            'Kinnim': { chapters: [4, 5, 6] },
            // Seder Taharos
            'Kelim': { chapters: [9, 8, 8, 4, 11, 4, 6, 11, 8, 8, 9, 8, 8, 8, 6, 8, 17, 9, 10, 7, 3, 10, 5, 17, 9, 9, 12, 10, 8, 4] },
            'Oholos': { chapters: [8, 7, 7, 3, 7, 7, 6, 6, 16, 7, 9, 8, 6, 7, 10, 5, 5, 10] },
            'Negaim': { chapters: [6, 5, 8, 11, 5, 8, 5, 10, 3, 10, 12, 7, 12, 13] },
            'Parah': { chapters: [4, 5, 11, 4, 9, 5, 12, 11, 9, 6, 9, 11] },
            'Taharos': { chapters: [10, 8, 8, 13, 9, 10, 9, 9, 9, 8] },
            'Mikvaos': { chapters: [8, 10, 4, 5, 6, 11, 7, 5, 7, 8] },
            'Niddah': { chapters: [7, 7, 7, 7, 9, 14, 5, 4, 11, 8] },
            'Machshirin': { chapters: [6, 11, 8, 10, 11, 8] },
            'Zavim': { chapters: [6, 4, 3, 7, 12] },
            'Tevul Yom': { chapters: [5, 8, 6, 7] },
            'Yadayim': { chapters: [5, 4, 5, 8] },
            'Uktzin': { chapters: [6, 10, 12] }
        };

        // Navi books and chapters
        const naviBooks = [
            { name: 'Yehoshua', chapters: 24 },
            { name: 'Shoftim', chapters: 21 },
            { name: 'Shmuel I', chapters: 31 },
            { name: 'Shmuel II', chapters: 24 },
            { name: 'Melachim I', chapters: 22 },
            { name: 'Melachim II', chapters: 25 },
            { name: 'Yeshayahu', chapters: 66 },
            { name: 'Yirmiyahu', chapters: 52 },
            { name: 'Yechezkel', chapters: 48 },
            { name: 'Hoshea', chapters: 14 },
            { name: 'Yoel', chapters: 4 },
            { name: 'Amos', chapters: 9 },
            { name: 'Ovadiah', chapters: 1 },
            { name: 'Yonah', chapters: 4 },
            { name: 'Michah', chapters: 7 },
            { name: 'Nachum', chapters: 3 },
            { name: 'Chavakuk', chapters: 3 },
            { name: 'Tzefaniah', chapters: 3 },
            { name: 'Chaggai', chapters: 2 },
            { name: 'Zechariah', chapters: 14 },
            { name: 'Malachi', chapters: 3 }
        ];
            // Mishnah Berurah schedule from Chicago Center (started July 2, 2025)
        const mishnahBerurahSchedule = {
            '2025-07-02': 'השכמה א,א',
            '2025-07-03': 'השכמה א,ב-ג',
            '2025-07-04': 'השכמה א,ד-ה',
            '2025-07-05': 'השכמה א,ו-ט',
            '2025-07-06': 'השכמה ב,א-ה',
            '2025-07-07': 'השכמה ב,ו-ג,ב',
            '2025-07-08': 'השכמה ג,ג-ז',
            '2025-07-09': 'השכמה ג,ח-יב',
            '2025-07-10': 'השכמה ג,יג-יז',
            '2025-07-11': 'נט״י שחרית ד,א',
            '2025-07-12': 'נט״י שחרית ד,ב-ז',
            '2025-07-13': 'תעניות תקמט,א-ב',
            '2025-07-14': 'נט״י שחרית ד,ח-יג',
            '2025-07-15': 'נט״י שחרית ד,יד-יז',
            '2025-07-16': 'נט״י שחרית ד,יח-כא',
            '2025-07-17': 'נט״י שחרית ד,כב-ה,א',
            '2025-07-18': 'נט״י שחרית ו,א',
            '2025-07-19': 'נט״י שחרית ו,ב',
            '2025-07-20': 'נט״י שחרית ו,ג-ד',
            '2025-07-21': 'תשעה באב תקנ,א-ב',
            '2025-07-22': 'תשעה באב תקנ,ג-ד',
            '2025-07-23': 'תשעה באב תקנא,א',
            '2025-07-24': 'תשעה באב תקנא,ב',
            '2025-07-25': 'תשעה באב תקנא,ג',
            '2025-07-26': 'תשעה באב תקנא,ד-ז',
            '2025-07-27': 'תשעה באב תקנא,ח-ט',
            '2025-07-28': 'תשעה באב תקנא,י',
            '2025-07-29': 'תשעה באב תקנא,יא-טו',
            '2025-07-30': 'תשעה באב תקנא,טז',
            '2025-07-31': 'תשעה באב תקנא,יז-יח',
            '2025-08-01': 'תשעה באב תקנב,א-ב',
            '2025-08-02': 'תשעה באב תקנב,ג-ח',
            '2025-08-03': 'תשעה באב תקנב,ט-יב',            
            '2025-08-04': 'נט״י שחרית ז, א-ד',
            '2025-08-05': 'ציצית ח,א-ב',
            '2025-08-06': 'ציצית ח,ג-ה',
            '2025-08-07': 'ציצית ח,ו-ט',
            '2025-08-08': 'ציצית ח,י-יא',
            '2025-08-09': 'ציצית ח,יב',
            '2025-08-10': 'ציצית ח,יג',
            '2025-08-11': 'ציצית ח,יד',
            '2025-08-12': 'ציצית ח,טו-יז',
            '2025-08-13': 'ציצית ט,א',
            '2025-08-14': 'ציצית ט,ב-ג',
            '2025-08-15': 'ציצית ט,ד-ו',
            '2025-08-16': 'ציצית י,א-ה',
            '2025-08-17': 'ציצית י,ו-ז',
            '2025-08-18': 'ציצית י,ח-י',
            '2025-08-19': 'ציצית י,יא-יב',
            '2025-08-20': 'ציצית יא,א',
            '2025-08-21': 'ציצית יא,ב',
            '2025-08-22': 'ציצית יא,ג',
            '2025-08-23': 'ציצית יא,ד-ה',
            '2025-08-24': 'ציצית יא,ו-ז',
            '2025-08-25': 'ציצית יא,ח-ט',
            '2025-08-26': 'ציצית יא,י-יא',
            '2025-08-27': 'ציצית יא,יב-יד',
            '2025-08-28': 'ציצית יא,טו',
            '2025-08-29': 'ציצית יב,א (סק״ז)',
            '2025-08-30': 'ציצית יב,א (סק״ח)-ג',
            '2025-08-31': 'ציצית יג,א-ב',
            '2025-09-01': 'ציצית יג,ג',
            '2025-09-02': 'ציצית יד,א-ב',
            '2025-09-03': 'ציצית יד,ג',
            '2025-09-04': 'ציצית יד,ד-ה',
            '2025-09-05': 'ציצית טו,א-ב',
            '2025-09-06': 'ציצית טו,ג-ד',
            '2025-09-07': 'סוכה תרכה,א',
            '2025-09-08': 'סוכה תרכו,א',
            '2025-09-09': 'סוכה תרכו,ב',
            '2025-09-10': 'סוכה תרכו,ג',
            '2025-09-11': 'סוכה תרכז,א-ב',
            '2025-09-12': 'סוכה תרכז,ג-ד',
            '2025-09-13': 'סוכה תרכח,א',
            '2025-09-14': 'סוכה תרכח,ב-ג',
            '2025-09-15': 'ראש השנה תקפא,א (סק״ח)',
            '2025-09-16': 'ראש השנה תקפא,א (ט-יד)',
            '2025-09-17': 'ראש השנה תקפא,ב',
            '2025-09-18': 'ראש השנה תקפא,ג-ד',
            '2025-09-19': 'ראש השנה תקפב,א-ב',
            '2025-09-20': 'ראש השנה תקפב,ג-ה',
            '2025-09-21': 'ראש השנה תקפב,ו-ט',
            '2025-09-22': 'ראש השנה תקפג,א-ב',
            '2025-09-23': 'ראש השנה תקפד,א',
            '2025-09-24': 'ראש השנה תקפד,ב-ד',
            '2025-09-25': 'תשובה תרב,א',
            '2025-09-26': 'יום כפור תרג,א',
            '2025-09-27': 'יום כפור תרד,א-ב',
            '2025-09-28': 'יום כפור תרה,א',
            '2025-09-29': 'יום כפור תרו,א-ב',
            '2025-09-30': 'יום כפור תרו,ג-ד',
            '2025-10-01': 'יום כפור תרז,א-ג',
            '2025-10-02': 'יום כפור תרז,ד-ו',
            '2025-10-03': 'סוכה תרכט,א-ג',
            '2025-10-04': 'סוכה תרכט,ד-ו',
            '2025-10-05': 'סוכה תרכט,ז-יא',
            '2025-10-06': 'סוכה תרכט,יב-יז',
            '2025-10-07': 'סוכה תרכט,יח',
            '2025-10-08': 'סוכה תרכט,יט',
            '2025-10-09': 'סוכה תרל,א-ב',
            '2025-10-10': 'סוכה תרל,ג-ד',
            '2025-10-11': 'סוכה תרל,ה',
            '2025-10-12': 'סוכה תרל,ו-ז',
            '2025-10-13': 'סוכה תרל,ח',
            '2025-10-14': 'סוכה תרל,ט-יא',
            '2025-10-15': 'סוכה תרל,יב-יג',
            '2025-10-16': 'ציצית טו,ה-ו',
            '2025-10-17': 'ציצית טז,א',
            '2025-10-18': 'ציצית יז,א-ג',
            '2025-10-19': 'ציצית יח,א-ג',
            '2025-10-20': 'ציצית יט,א-כ,ב',
            '2025-10-21': 'ציצית כא,א-ב',
            '2025-10-22': 'ציצית כא,ג-כב,א',
            '2025-10-23': 'ציצית כג,א-כד,ו',
            '2025-10-24': 'תפילין כה,א',
            '2025-10-25': 'תפילין כה,ב-ד',
            '2025-10-26': 'תפילין כה,ה',
            '2025-10-27': 'תפילין כה,ו-ט',
            '2025-10-28': 'תפילין כה,י-יא',
            '2025-10-29': 'תפילין כה,יב',
            '2025-10-30': 'תפילין כה,יג',
            '2025-10-31': 'תפילין כו,א-ב',
            '2025-11-01': 'תפילין כז,א',
            '2025-11-02': 'תפילין כז,ב-ג',
            '2025-11-03': 'תפילין כז,ד-ה',
            '2025-11-04': 'תפילין כז,ו-ח',
            '2025-11-05': 'תפילין כז,ט-י',
            '2025-11-06': 'תפילין כז,יא',
            '2025-11-07': 'תפילין כח,א-ג',
            '2025-11-08': 'תפילין כט,א-ל,ב',
            '2025-11-09': 'תפילין ל,ג-ה',
            '2025-11-10': 'תפילין לא,א-ב',
            '2025-11-11': 'תפילין לב,א-ב',
            '2025-11-12': 'תפילין לב,ג',
            '2025-11-13': 'תפילין לב,ד-ה',
            '2025-11-14': 'תפילין לב,ו-ז',
            '2025-11-15': 'תפילין לב,ח-ט',
            '2025-11-16': 'תפילין לב,י-יג',
            '2025-11-17': 'תפילין לב,יד-טו',
            '2025-11-18': 'תפילין לב,טז-(סק״נב)',
            '2025-11-19': 'תפילין לב, (סק״נג-ס)',
            '2025-11-20': 'תפילין לב,יז',
            '2025-11-21': 'תפילין לב,יח-(סק״עה)',
            '2025-11-22': 'תפילין לב,(סק״עו-פא)',
            '2025-11-23': 'תפילין לב,(סק״פב-צא)',
            '2025-11-24': 'תפילין לב,יט',
            '2025-11-25': 'תפילין לב,כ-כב',
            '2025-11-26': 'תפילין לב,כג-כד',
            '2025-11-27': 'תפילין לב,כה',
            '2025-11-28': 'תפילין לב,כו-כז',
            '2025-11-29': 'תפילין לב,כח-לב',
            '2025-11-30': 'תפילין לב,לג-לה',
            '2025-12-01': 'תפילין לב,לו-(סק״קסא)',
            '2025-12-02': 'תפילין לב,לו (קסב-קסד)',
            '2025-12-03': 'תפילין לב,לז',
            '2025-12-04': 'תפילין לב,לח-לט',
            '2025-12-05': 'תפילין לב,מ-מא',
            '2025-12-06': 'תפילין לב,מב-מג',
            '2025-12-07': 'תפילין לב,מד',
            '2025-12-08': 'תפילין לב,מה-מט',
            '2025-12-09': 'תפילין לב,נ-נב',
            '2025-12-10': 'תפילין לג,א-ב',
            '2025-12-11': 'תפילין לג,ג',
            '2025-12-12': 'תפילין לג,ד',
            '2025-12-13': 'תפילין לג,ה',
            '2025-12-14': 'חנוכה תרע,א-ב',
            '2025-12-15': 'חנוכה תרע,ג-תרעא,ב',
            '2025-12-16': 'חנוכה תרעא,ג-ד',
            '2025-12-17': 'חנוכה תרעא,ה-ו',
            '2025-12-18': 'חנוכה תרעא,ז',
            '2025-12-19': 'חנוכה תרעא,ח',
            '2025-12-20': 'חנוכה תרעב,א',
            '2025-12-21': 'חנוכה תרעב,ב',
            '2025-12-22': 'תפילין לד,א',
            '2025-12-23': 'תפילין לד,ב',
            '2025-12-24': 'תפילין לד,ג-ד',
            '2025-12-25': 'תפילין לה,א-לו,א',
            '2025-12-26': 'תפילין לו,ב-ג',
            '2025-12-27': 'תפילין לז,א-ג',
            '2025-12-28': 'תפילין לח,א-ד',
            '2025-12-29': 'תפילין לח,ה-ז',
            '2025-12-30': 'תפילין לח,ח-ט',
            '2025-12-31': 'תפילין לח,י-יג',
            '2026-01-01': 'תפילין לט,א',
            '2026-01-02': 'תפילין לט,ב-ג',
            '2026-01-03': 'תפילין לט,ד-ז',
            '2026-01-04': 'תפילין לט,ח-י',
            '2026-01-05': 'תפילין מ,א-ב',
            '2026-01-06': 'תפילין מ, ג-ח',
            '2026-01-07': 'תפילין מא,א',
            '2026-01-08': 'תפילין מב,א-ב',
            '2026-01-09': 'תפילין מב,ג-(סקט״ז)',
            '2026-01-10': 'תפילין מב,ג (יז-כו)',
            '2026-01-11': 'תפילין מג,א-ד',
            '2026-01-12': 'תפילין מג,ה-ט',
            '2026-01-13': 'תפילין מד,א',
            '2026-01-14': 'תפילין מה,א-ב',
            '2026-01-15': 'ברכות השחר מו,א-ג',
            '2026-01-16': 'ברכות השחר מו,ד-ח',
            '2026-01-17': 'ברכות השחר מו,ט',
            '2026-01-18': 'ברכות השחר מז,א-ד',
            '2026-01-19': 'ברכות השחר מז,ה-ט',
            '2026-01-20': 'ברכות השחר מז,י-יב',
            '2026-01-21': 'ברכות השחר מז,יג-יד',
            '2026-01-22': 'ברכות השחר מח,א-מט,א',
            '2026-01-23': 'ברכות השחר נ,א-נא,ג',
            '2026-01-24': 'ברכות השחר נא,ד-ה',
            '2026-01-25': 'ברכות השחר נא,ו-ט',
            '2026-01-26': 'ברכות השחר נב,א',
            '2026-01-27': 'ברכות השחר נג,א-ג',
            '2026-01-28': 'ברכות השחר נג,ד',
            '2026-01-29': 'ברכות השחר נג,ה-ו',
            '2026-01-30': 'ברכות השחר נג,ז-י',
            '2026-01-31': 'ברכות השחר נג,יא-טז',
            '2026-02-01': 'ברכות השחר נג,יז-יט',
            '2026-02-02': 'ברכות השחר נג,כ-כב',
            '2026-02-03': 'ברכות השחר נג,כג-כד',
            '2026-02-04': 'ברכות השחר נג,כה',
            '2026-02-05': 'ברכות השחר נג,כו-נד,ב',
            '2026-02-06': 'ברכות השחר נד,ג',
            '2026-02-07': 'ברכות השחר נה,א-ב',
            '2026-02-08': 'ברכות השחר נה,ג-ד',
            '2026-02-09': 'ברכות השחר נה,ה-ט',
            '2026-02-10': 'ברכות השחר נה,י-יג',
            '2026-02-11': 'ברכות השחר נה,יד-יז',
            '2026-02-12': 'ברכות השחר נה,יח-כב',
            '2026-02-13': 'ברכות השחר נו,א',
            '2026-02-14': 'ברכות השחר נו,ב-נז,ב',
            '2026-02-15': 'קריאת שמע נח,א',
            '2026-02-16': 'קריאת שמע נח,ב-ד',
            '2026-02-17': 'קריאת שמע נח,ה-ז',
            '2026-02-18': 'קריאת שמע נט,א-ב',
            '2026-02-19': 'קריאת שמע נט,ג-ד',
            '2026-02-20': 'קריאת שמע נט,ה-ס,ב',
            '2026-02-21': 'קריאת שמע ס,ג-ד',
            '2026-02-22': 'קריאת שמע ס,ה-סא,ב',
            '2026-02-23': 'קריאת שמע סא,ג-ו',
            '2026-02-24': 'קריאת שמע סא,ז-יג',
            '2026-02-25': 'קריאת שמע סא,יד-כא',
            '2026-02-26': 'קריאת שמע סא,כב-כו',
            '2026-02-27': 'קריאת שמע סב,א-ה',
            '2026-02-28': 'קריאת שמע סג,א-ג',
            '2026-03-01': 'קריאת שמע סג,ד-ט',
            '2026-03-02': 'קריאת שמע סד,א-ד',
            '2026-03-03': 'קריאת שמע סה,א',
            '2026-03-04': 'קריאת שמע סה,ב-ג',
            '2026-03-05': 'קריאת שמע סו,א',
            '2026-03-06': 'קריאת שמע סו,ב-ג',
            '2026-03-07': 'קריאת שמע סו,ד-ה',
            '2026-03-08': 'קריאת שמע סו,ו-ח',
            '2026-03-09': 'קריאת שמע סו,ט-י',
            '2026-03-10': 'קריאת שמע סז,א',
            '2026-03-11': 'קריאת שמע סח,א',
            '2026-03-12': 'קריאת שמע סט, א (מחבר)',
            '2026-03-13': 'קריאת שמע סט,א (רמ״א)-ב',
            '2026-03-14': 'מגילה תרפה,א-ה',
            '2026-03-15': 'מגילה תרפה,ו-ז',
            '2026-03-16': 'מגילה תרפו,א-ג',
            '2026-03-17': 'מגילה תרפז,א-ב',
            '2026-03-18': 'מגילה תרפח,א-ב',
            '2026-03-19': 'מגילה, פסח תרפח,ג-ה, תכט,א',
            '2026-03-20': 'מגילה, פסח תרפח,ו-ח, תכט,ב',
            '2026-03-21': 'פסח תל,א-תלא,א',
            '2026-03-22': 'פסח תלא,ב-תלב,א',
            '2026-03-23': 'פסח תלב,ב',
            '2026-03-24': 'פסח תלג,א-ג',
            '2026-03-25': 'פסח תלג,ד-ז',
            '2026-03-26': 'פסח תלג,ח-ט',
            '2026-03-27': 'פסח תלג,י-תלד,א',
            '2026-03-28': 'פסח תלד,ב-ד',
            '2026-03-29': 'פסח תלה,א',
            '2026-03-30': 'פסח תלו,א',
            '2026-03-31': 'פסח תלו,ב-ג',
            '2026-04-01': 'פסח תלז,א-ב',
            '2026-04-02': 'פסח תלז,ג-ד',
            '2026-04-03': 'פסח תלח,א-ב',
            '2026-04-04': 'פסח תלט,א-ד',
            '2026-04-05': 'פסח תמ,א',
            '2026-04-06': 'פסח תמ,ב-ד',
            '2026-04-07': 'פסח תמא,א-ב',
            '2026-04-08': 'פסח תמב,א',
            '2026-04-09': 'פסח תמב,ב-ג',
            '2026-04-10': 'פסח תמב,ד-ה',
            '2026-04-11': 'פסח תמב,ו-ח',
            '2026-04-12': 'פסח תמב,ט',
            '2026-04-13': 'פסח תמב,י-יא',
            '2026-04-14': 'פסח תמג,א',
            '2026-04-15': 'פסח תמג,ב',
            '2026-04-16': 'פסח תמג,ג',
            '2026-04-17': 'פסח תמד,א-ב',
            '2026-04-18': 'פסח תמד,ג-ה',
            '2026-04-19': 'פסח תמד,ו-ח',
            '2026-04-20': 'פסח תמה,א',
            '2026-04-21': 'פסח תמה,ב-ג',
            '2026-04-22': 'פסח תמו,א',
            '2026-04-23': 'פסח תמו,ב-ד',
            '2026-04-24': 'ספירת העומר תפט,א',
            '2026-04-25': 'ספירת העומר תפט,ב-ג',
            '2026-04-26': 'ספירת העומר תפט,ד-ו',
            '2026-04-27': 'ספירת העומר תפט,ז-ט',
            '2026-04-28': 'ספירת העומר תפט,י',
            '2026-04-29': 'קריאת שמע סא,כב-כו',
            '2026-04-30': 'קריאת שמע סב,א-ה',
            '2026-05-01': 'קריאת שמע סג,א-ג',
            '2026-05-02': 'קריאת שמע סג,ד-ט',
            '2026-05-03': 'קריאת שמע סד,א-ד',
            '2026-05-04': 'חג השבועות תצד,א-ב',
            '2026-05-05': 'חג השבועות תצד,ג',
            '2026-05-06': 'יום טוב תצה,א-ג',
            '2026-05-07': 'יום טוב תצה,ד',
            '2026-05-08': 'יום טוב תצו,א',
            '2026-05-09': 'יום טוב תצו,ב',
            '2026-05-10': 'יום טוב תצו,ג',
            '2026-05-11': 'קריאת שמע עט,ד-ח',
            '2026-05-12': 'קריאת שמע עט,ט-פ,א',
            '2026-05-13': 'קריאת שמע פא,א-ב',
            '2026-05-14': 'קריאת שמע פב,א-פג,א',
            '2026-05-15': 'קריאת שמע פג,ב-ה',
            '2026-05-16': 'קריאת שמע פד,א',
            '2026-05-17': 'קריאת שמע פה,א-ב',
            '2026-05-18': 'קריאת שמע פו,א-פז,א',
            '2026-05-19': 'קריאת שמע פז,ב-ג',
            '2026-05-20': 'קריאת שמע פח,א',
            '2026-05-21': 'תפילה פט,א',
            '2026-05-22': 'תפילה פט,ב',
            '2026-05-23': 'תפילה פט,ג-ד',
            '2026-05-24': 'תפילה פט,ה-ז',
            '2026-05-25': 'תפילה פט,ח-צ,ג',
            '2026-05-26': 'תפילה צ,ד-ז',
            '2026-05-27': 'תפילה צ,ח-ט',
            '2026-05-28': 'תפילה צ,י-יב',
            '2026-05-29': 'תפילה צ,יג-יח',
            '2026-05-30': 'תפילה צ,יט-כג',
            '2026-05-31': 'תפילה צ,כד-כז',
            '2026-06-01': 'תפילה צא,א-ו',
            '2026-06-02': 'תפילה צב,א',
            '2026-06-03': 'תפילה צב,ב-ג',
            '2026-06-04': 'תפילה צב,ד-ז',
            '2026-06-05': 'תפילה צב,ח-צג,ד',
            '2026-06-06': 'תפילה צד,א-ב',
            '2026-06-07': 'תפילה צד,ג-ח',
            '2026-06-08': 'תפילה צד,ט-צה,ד',
            '2026-06-09': 'תפילה צו,א-ב',
            '2026-06-10': 'תפילה צז,א-ה',
            '2026-06-11': 'תפילה צח,א-ה',
            '2026-06-12': 'תפילה צט,א-ג',
            '2026-06-13': 'תפילה ק,א-קא,ב',
            '2026-06-14': 'תפילה קא,ג-ד',
            '2026-06-15': 'תפילה קב,א-ה',
            '2026-06-16': 'תפילה קג,א-קד,א',
            '2026-06-17': 'תפילה קד,ב-ד',
            '2026-06-18': 'תפילה קד,ה-ו',
            '2026-06-19': 'תעניות תקמט,א-ב',
            '2026-06-20': 'תפילה קד,ז-קו,א',
            '2026-06-21': 'תפילה קו,ב',
            '2026-06-22': 'תפילה קז,א-ב',
            '2026-06-23': 'תפילה קז, ג- קח,ב',
            '2026-06-24': 'תשעה באב תקנג,א-ב',
            '2026-06-25': 'תשעה באב תקנד,א-ג',
            '2026-06-26': 'תשעה באב תקנד,ד-ו',
            '2026-06-27': 'תשעה באב תקנד,ז-י',
            '2026-06-28': 'תשעה באב תקנד,יא-טז',
            '2026-06-29': 'תשעה באב תקנד,יז-כא',
            '2026-06-30': 'תשעה באב תקנד,כב-כה',
            '2026-07-01': 'תשעה באב תקנה,א-תקנו,א',
            '2026-07-02': 'תשעה באב תקנז,א',
            '2026-07-03': 'תשעה באב תקנח,א',
            '2026-07-04': 'תשעה באב תקנט,א-ג',
            '2026-07-05': 'תשעה באב תקנט,ד-ו',
            '2026-07-06': 'תשעה באב תקנט,ז-ח',
            '2026-07-07': 'תשעה באב תקנט,ט-י',
            '2026-07-08': 'תשעה באב תקס,א-ב',
            '2026-07-09': 'תשעה באב תקס,ג-ה',
            '2026-07-10': 'תשעה באב תקסא,א-ה',
            '2026-07-11': 'תפילה קח,ג-ז',
            '2026-07-12': 'תפילה קח,ח-י',
            '2026-07-13': 'תפילה קח,יא-יב',
            '2026-07-14': 'תפילה קט,א',
            '2026-07-15': 'תפילה קט,ב-ג',
            '2026-07-16': 'תפילה קי,א-ג',
            '2026-07-17': 'תפילה קי,ד-ו',
            '2026-07-18': 'תפילה קי,ז-ח',
            '2026-07-19': 'תפילה קיא,א-קיב,ב',
            '2026-07-20': 'תפילה קיג,א-ט',
            '2026-07-21': 'תפילה קיד,א-ב',
            '2026-07-22': 'תפילה קיד,ג-ד',
            '2026-07-23': 'תפילה קיד,ה-ו',
            '2026-07-24': 'תפילה קיד,ז-ח',
            '2026-07-25': 'תפילה קיד,ט-קטו,א',
            '2026-07-26': 'תפילה קטז,א-קיז,א',
            '2026-07-27': 'תפילה קיז,ב-ג',
            '2026-07-28': 'תפילה קיז,ד-קיח,א',
            '2026-07-29': 'תפילה קיט,א-ב',
            '2026-07-30': 'תפילה קיט,ג-קכ,א',
            '2026-07-31': 'תפילה קכא,א-קכב,א',
            '2026-08-01': 'תפילה קכב,ב-קכג,ב',
            '2026-08-02': 'תפילה קכג,ג-ו',
            '2026-08-03': 'תפילה קכד,א-ג',
            '2026-08-04': 'תפילה קכד,ד-ה',
            '2026-08-05': 'תפילה קכד,ו-ז',
            '2026-08-06': 'תפילה קכד,ח',
            '2026-08-07': 'תפילה קכד,ט-יד',
            '2026-08-08': 'תפילה קכה,א-ב',
            '2026-08-09': 'תפילה קכו,א-ב',
            '2026-08-10': 'תפילה קכו,ג-קכז,ב',
            '2026-08-11': 'נשיאת כפים קכח,א',
            '2026-08-12': 'נשיאת כפים קכח,ב-ג',
            '2026-08-13': 'סוכה תרלא,א-ה',
            '2026-08-14': 'סוכה תרלא,ו-ח',
            '2026-08-15': 'סוכה תרלא,ט',
            '2026-08-16': 'סוכה תרלא,י',
            '2026-08-17': 'סוכה תרלב,א',
            '2026-08-18': 'סוכה תרלב,ב-ד',
            '2026-08-19': 'סוכה תרלג,א-ב',
            '2026-08-20': 'סוכה תרלג,ג-ו',
            '2026-08-21': 'סוכה תרלג,ז-י',
            '2026-08-22': 'ראש השנה תקפה,א-ב',
            '2026-08-23': 'ראש השנה תקפה,ג-ה',
            '2026-08-24': 'ראש השנה תקפו,א',
            '2026-08-25': 'ראש השנה תקפו,ב-ג',
            '2026-08-26': 'ראש השנה תקפו,ד-ה',
            '2026-08-27': 'ראש השנה תקפו,ו-ז',
            '2026-08-28': 'ראש השנה תקפו,ח',
            '2026-08-29': 'ראש השנה תקפו,ט-י',
            '2026-08-30': 'ראש השנה תקפו,יא-יט',
            '2026-08-31': 'ראש השנה תקפו,כ-כג',
            '2026-09-01': 'יום כיפור תרח,א-ב',
            '2026-09-02': 'יום כיפור תרח,ג-ד',
            '2026-09-03': 'יום כיפור תרט,א-תרי,ד',
            '2026-09-04': 'יום כיפור תריא,א-ב',
            '2026-09-05': 'יום כיפור תריב,א-ג',
            '2026-09-06': 'יום כיפור תריב,ד-ז',
            '2026-09-07': 'יום כיפור תריב,ח-י',
            '2026-09-08': 'יום כיפור תריג,א-ד',
            '2026-09-09': 'סוכה תרלד,א-ב',
            '2026-09-10': 'סוכה תרלד,ג-ד',
            '2026-09-11': 'סוכה תרלה,א',
            '2026-09-12': 'סוכה תרלו,א-ב',
            '2026-09-13': 'סוכה תרלז,א-ב',
            '2026-09-14': 'סוכה תרלז,ג',
            '2026-09-15': 'סוכה תרלח,א',
            '2026-09-16': 'סוכה תרלח,ב',
            '2026-09-17': 'לולב תרסד,א-ד',
            '2026-09-18': 'לולב תרסד,ה-יא',
            '2026-09-19': 'לולב תרסה,א-תרסו,א',
            '2026-09-20': 'לולב תרסז,א',
            '2026-09-21': 'לולב תרסח,א',
            '2026-09-22': 'נשיאת כפים קכח,ד-ה',
            '2026-09-23': 'נשיאת כפים קכח,ו-ח',
            '2026-09-24': 'נשיאת כפים קכח,ט-י',
            '2026-09-25': 'נשיאת כפים קכח,יא-יד',
            '2026-09-26': 'נשיאת כפים קכח,טו-יח',
            '2026-09-27': 'נשיאת כפים קכח,יט-כ',
            '2026-09-28': 'נשיאת כפים קכח,כא-כג',
            '2026-09-29': 'נשיאת כפים קכח,כד-כה',
            '2026-09-30': 'נשיאת כפים קכח,כו-כט',
            '2026-10-01': 'נשיאת כפים קכח,ל-לג',
            '2026-10-02': 'נשיאת כפים קכח,לד-לו',
            '2026-10-03': 'נשיאת כפים קכח,לז-לח',
            '2026-10-04': 'נשיאת כפים קכח,לט-מא',
            '2026-10-05': 'נשיאת כפים קכח,מב-מד',
            '2026-10-06': 'נשיאת כפים קכח,מה',
            '2026-10-07': 'נשיאת כפים קכט,א-ב',
            '2026-10-08': 'נשיאת כפים קל,א',
            '2026-10-09': 'נפילת אפים קלא,א',
            '2026-10-10': 'נפילת אפים קלא,ב-ג',
            '2026-10-11': 'נפילת אפים קלא,ד',
            '2026-10-12': 'נפילת אפים קלא,ה-ז',
            '2026-10-13': 'נפילת אפים קלא,ח',
            '2026-10-14': 'תפילה קלב,א',
            '2026-10-15': 'תפילה קלב,ב',
            '2026-10-16': 'תפילה קלג,א-קלד,א',
            '2026-10-17': 'תפילה קלד,ב',
            '2026-10-18': 'תפילה קלה,א-ב',
            '2026-10-19': 'תפילה קלה,ג-ה',
            '2026-10-20': 'תפילה קלה,ו-ט',
            '2026-10-21': 'תפילה קלה,י',
            '2026-10-22': 'תפילה קלה,יא-יד',
            '2026-10-23': 'תפילה קלו,א',
            '2026-10-24': 'קריאת התורה קלז,א-ג',
            '2026-10-25': 'קריאת התורה קלז,ד',
            '2026-10-26': 'קריאת התורה קלז,ה-ו',
            '2026-10-27': 'קריאת התורה קלח,א',
            '2026-10-28': 'קריאת התורה קלט,א-ג',
            '2026-10-29': 'קריאת התורה קלט,ד-ה',
            '2026-10-30': 'קריאת התורה קלט,ו-יא',
            '2026-10-31': 'קריאת התורה קמ,א-ג',        
        };

        // Jewish holidays
        const holidays = {
            '2025-09-23': 'ראש השנה א׳',
            '2025-09-24': 'ראש השנה ב׳',
            '2025-10-02': 'יום כפור',
            '2025-10-07': 'סוכות',
            '2025-10-08': 'סוכות',
            '2025-10-09': 'חול המועד',
            '2025-10-10': 'חול המועד',
            '2025-10-11': 'חול המועד',
            '2025-10-12': 'חול המועד',
            '2025-10-13': 'הושענה רבה',
            '2025-10-14': 'שמיני עצרת',
            '2025-10-15': 'שמחת תורה',
            '2025-12-15': 'חנוכה',
            '2025-12-16': 'חנוכה',
            '2025-12-17': 'חנוכה',
            '2025-12-18': 'חנוכה',
            '2025-12-19': 'חנוכה',
            '2025-12-20': 'חנוכה',
            '2025-12-21': 'חנוכה',
            '2025-12-22': 'חנוכה',
            '2025-12-30': 'עשרה בטבת',
            '2026-02-02': 'ט״ו בשבט',
            '2026-03-03': 'תענית אסתר',
            '2026-03-03': 'פורים',
            '2026-04-02': 'פסח',
            '2026-04-03': 'פסח',
            '2026-04-04': 'חול המועד',
            '2026-04-05': 'חול המועד',
            '2026-04-06': 'חול המועד',
            '2026-04-07': 'חול המועד',
            '2026-04-08': 'פסח',
            '2026-04-09': 'פסח',
            '2026-05-22': 'שבועות',
            '2026-05-23': 'שבועות',
            '2026-07-02': 'שבעה עשר בתמוז',
            '2026-07-23': 'תשעה באב'
        };

        // Progress tracking
        let progressData = {};

        function saveProgress(date, learningType, isCompleted) {
            const progressKey = `${date}_${learningType}`;
            if (isCompleted) {
                progressData[progressKey] = 'completed';
            } else {
                delete progressData[progressKey];
            }
        }

        function getProgress(date, learningType) {
            const progressKey = `${date}_${learningType}`;
            return progressData[progressKey] === 'completed';
        }

        // Helper functions
        function isHoliday(dateStr) {
            return holidays[dateStr] || false;
        }

        function isShabbat(date) {
            return date.getDay() === 6;
        }

        function isToday(date) {
            const today = new Date();
            return date.getDate() === today.getDate() &&
                date.getMonth() === today.getMonth() &&
                date.getFullYear() === today.getFullYear();
        }

        function getHebrewDate(gregorianDate) {
            try {
                const hebrewDate = new Intl.DateTimeFormat('he-u-ca-hebrew', {
                    day: 'numeric',
                    month: 'long'
                }).format(gregorianDate);
                return hebrewDate;
            } catch (error) {
                return '';
            }
        }

        // Current learning positions
        let currentMishnah = { tractate: 'Kesubos', chapter: 7, mishnah: 7 };
        let currentNavi = { book: 'Melachim II', chapter: 17 };

        function getNextMishnah(current) {
            const tractate = current.tractate;
            const chapter = current.chapter;
            const mishnah = current.mishnah;
            
            const maxMishnahs = mishnayos[tractate].chapters[chapter - 1];
            
            if (mishnah < maxMishnahs) {
                return { tractate, chapter, mishnah: mishnah + 1 };
            } else if (chapter < mishnayos[tractate].chapters.length) {
                return { tractate, chapter: chapter + 1, mishnah: 1 };
            } else {
                const tractateNames = Object.keys(mishnayos);
                const currentIndex = tractateNames.indexOf(tractate);
                if (currentIndex < tractateNames.length - 1) {
                    const nextTractate = tractateNames[currentIndex + 1];
                    return { tractate: nextTractate, chapter: 1, mishnah: 1 };
                } else {
                    return { tractate: 'Kesubos', chapter: 1, mishnah: 1 };
                }
            }
        }

        function getNextNavi(current) {
            const bookIndex = naviBooks.findIndex(book => book.name === current.book);
            const book = naviBooks[bookIndex];
            
            if (current.chapter < book.chapters) {
                return { book: current.book, chapter: current.chapter + 1 };
            } else if (bookIndex < naviBooks.length - 1) {
                return { book: naviBooks[bookIndex + 1].name, chapter: 1 };
            } else {
                return { book: 'Yehoshua', chapter: 1 };
            }
        }

        function formatMishnahRef(mishnah) {
            return `${mishnah.tractate} ${mishnah.chapter}:${mishnah.mishnah}`;
        }

        function formatNaviRef(navi) {
            return `${navi.book} ${navi.chapter}`;
        }

        // Link generation functions
        function getSefariaLink(tractate, chapter, mishnah) {
            const sefariaNames = {
                'Kesubos': 'Ketubot',
                'Nedarim': 'Nedarim',
                'Nazir': 'Nazir',
                'Sotah': 'Sotah',
                'Gittin': 'Gittin',
                'Kiddushin': 'Kiddushin'
            };
            const sefariaName = sefariaNames[tractate] || tractate;
            return `https://www.sefaria.org/Mishnah_${sefariaName}.${chapter}.${mishnah}?lang=bi`;
        }

        function getNaviAudioLink(book, chapter) {
            return `https://outorah.org/author/1070`;
        }

        function openMishnahBerurahWithDate(reference, date, event) {
            event.preventDefault();
            event.stopPropagation();
            
            const displayDate = new Date(date).toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric', 
                month: 'long', 
                day: 'numeric'
            });
            
            window.open('https://mishnaberurayomi.org/archive.php', '_blank');
            
            setTimeout(() => {
                alert(`📚 Archive page opened!\n\nTo find today's Mishnah Berurah:\n\n📅 Search for: ${displayDate}\n📖 Learning: ${reference}\n\nThe archive will show you the correct PDF for this date.`);
            }, 500);
        }

        // Make toggleCheckbox globally accessible
        window.toggleCheckbox = function(element, date, learningType) {
            const isChecked = element.classList.contains('checked');
            
            if (isChecked) {
                element.classList.remove('checked');
                element.innerHTML = '';
                saveProgress(date, learningType, false);
            } else {
                element.classList.add('checked');
                element.innerHTML = '✓';
                saveProgress(date, learningType, true);
            }
        }

        // Make openMishnahBerurahWithDate globally accessible
        window.openMishnahBerurahWithDate = openMishnahBerurahWithDate;

        function generateCalendar() {
            const monthSelect = document.getElementById('monthSelect');
            const selectedValue = monthSelect.value;
            const [year, month] = selectedValue.split('-').map(Number);
            
            const date = new Date(year, month - 1, 1);
            const monthName = date.toLocaleString('default', { month: 'long', year: 'numeric' });
            
            let calendarHTML = `
                <div class="calendar-container">
                    <div class="calendar-header">
                        <h1>${monthName}</h1>
                        <div class="hebrew-month">לוח לימוד יומי</div>
                    </div>
                    <div class="calendar-grid">
                        <div class="day-header">Sunday</div>
                        <div class="day-header">Monday</div>
                        <div class="day-header">Tuesday</div>
                        <div class="day-header">Wednesday</div>
                        <div class="day-header">Thursday</div>
                        <div class="day-header">Friday</div>
                        <div class="day-header">Shabbat</div>
            `;

            const firstDay = new Date(year, month - 1, 1);
            const startGrid = new Date(firstDay);
            startGrid.setDate(startGrid.getDate() - firstDay.getDay());

            let currentDate = new Date(startGrid);

            for (let i = 0; i < 42; i++) {
                const isCurrentMonth = currentDate.getMonth() === (month - 1);
                const dateStr = currentDate.toISOString().split('T')[0];
                const holiday = isHoliday(dateStr);
                const shabbat = isShabbat(currentDate);
                const today = isToday(currentDate);
                
                let cellClass = 'calendar-cell';
                if (!isCurrentMonth) cellClass += ' other-month';
                if (shabbat) cellClass += ' shabbat';
                if (today) cellClass += ' today';

                let learningContent = '';
                if (isCurrentMonth) {
                    const july20 = new Date(2025, 6, 20);
                    const daysDiff = Math.floor((currentDate - july20) / (1000 * 60 * 60 * 24));
                    
                    let dayMishnahPos = { ...currentMishnah };
                    let dayNaviPos = { ...currentNavi };
                    
                    for (let j = 0; j <= daysDiff; j++) {
                        dayMishnahPos = getNextMishnah(dayMishnahPos);
                        dayMishnahPos = getNextMishnah(dayMishnahPos);
                        dayNaviPos = getNextNavi(dayNaviPos);
                    }

                    const mishnah1 = formatMishnahRef(dayMishnahPos);
                    const mishnah1Link = getSefariaLink(dayMishnahPos.tractate, dayMishnahPos.chapter, dayMishnahPos.mishnah);
                    
                    dayMishnahPos = getNextMishnah(dayMishnahPos);
                    const mishnah2 = formatMishnahRef(dayMishnahPos);
                    const mishnah2Link = getSefariaLink(dayMishnahPos.tractate, dayMishnahPos.chapter, dayMishnahPos.mishnah);
                    
                    const naviRef = formatNaviRef(dayNaviPos);
                    const naviAudioLink = getNaviAudioLink(dayNaviPos.book, dayNaviPos.chapter);
                    const mbRef = mishnahBerurahSchedule[dateStr] || 'עיין בלוח';

                    const m1Checked = getProgress(dateStr, 'mishnah1') ? 'checked' : '';
                    const m2Checked = getProgress(dateStr, 'mishnah2') ? 'checked' : '';
                    const naviChecked = getProgress(dateStr, 'navi') ? 'checked' : '';
                    const mbChecked = getProgress(dateStr, 'mb') ? 'checked' : '';

                    const dayTitle = shabbat ? "Shabbat Learning:" : "Today's Learning:";

                    learningContent = `
                        <div class="learning-section">
                            <div class="learning-title">${dayTitle}</div>
                            <div class="learning-item">
                                <span class="checkbox ${m1Checked}" onclick="toggleCheckbox(this, '${dateStr}', 'mishnah1')">
                                    ${m1Checked ? '✓' : ''}
                                </span>
                                <a href="${mishnah1Link}" target="_blank" class="learning-label mishnah-ref">${mishnah1}</a>
                            </div>
                            <div class="learning-item">
                                <span class="checkbox ${m2Checked}" onclick="toggleCheckbox(this, '${dateStr}', 'mishnah2')">
                                    ${m2Checked ? '✓' : ''}
                                </span>
                                <a href="${mishnah2Link}" target="_blank" class="learning-label mishnah-ref">${mishnah2}</a>
                            </div>
                            <div class="learning-item">
                                <span class="checkbox ${naviChecked}" onclick="toggleCheckbox(this, '${dateStr}', 'navi')">
                                    ${naviChecked ? '✓' : ''}
                                </span>
                                <a href="${naviAudioLink}" target="_blank" class="learning-label navi-ref">${naviRef}</a>
                            </div>
                            <div class="learning-item">
                                <span class="checkbox ${mbChecked}" onclick="toggleCheckbox(this, '${dateStr}', 'mb')">
                                    ${mbChecked ? '✓' : ''}
                                </span>
                                <a href="#" onclick="openMishnahBerurahWithDate('${mbRef}', '${dateStr}', event)" class="learning-label mb-ref">${mbRef}</a>
                            </div>
                        </div>
                    `;
                }

                calendarHTML += `
                    <div class="${cellClass}">
                        <div class="date-info">
                            <span class="secular-date">${currentDate.getDate()}</span>
                            <span class="hebrew-date">${getHebrewDate(currentDate)}</span>
                        </div>
                        ${holiday ? `<div class="holiday-name">${holiday}</div>` : ''}
                        ${learningContent}
                    </div>
                `;

                currentDate.setDate(currentDate.getDate() + 1);
            }

            calendarHTML += '</div></div>';
            document.getElementById('calendarOutput').innerHTML = calendarHTML;
        }

        function exportToCalendar() {
            alert('Export feature will download an .ics file for importing to your calendar app.');
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('generateBtn').addEventListener('click', generateCalendar);
            document.getElementById('printBtn').addEventListener('click', function() { 
                window.print(); 
            });
            document.getElementById('exportBtn').addEventListener('click', exportToCalendar);
            
            // Generate initial calendar
            generateCalendar();
        });
    </script>
</body>
</html>
